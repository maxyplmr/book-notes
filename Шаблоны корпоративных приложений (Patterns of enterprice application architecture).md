# Расслоение системы

**Концепция слоев (layers)** - Общеупотребительная модель для разделения сложных систем на более простые части.

Слои более высокого уровня пользуются службами, нижних слоев которые не  знают о наличии верхних.

Модификации слоя часто связаны с необходимостью внесения **каскадных изменений** в остальные слои.

Наличие избыточных слоев снижает производительность системы. 

### Три основных слоя
 - Представление ( presentation )
 - Бизнес логика / предметная область ( domain )
 - Источник данных ( data source )
 
#### Представление ( presentation )
Охватывает все что имеет отношение пользователя с системой. Главная его функция отображение информации.

#### Бизнес логика / предметная область ( domain )
Описывает основные функции приложения. Вычисления на основе вводимых или хранимых данных, проверка всех элементов данных, обработка команд от слоя представления и передача их к слою источника данных.

#### Источник данных ( data source )
Подмножество функций обеспечивающих взаимодействие с другими сервисами, мониторинг транзакций, управление другими приложениями, обмена сообщениями и тд.
Для большинства корпоративных приложений, основная часть логики код СУБД.

# Организация бизнес логики

### Три типовых решения распределения
 - Сценарий транзакций ( Transaction Script )
 - Модель предметной области ( Domain Model )
 - Модуль таблицы ( Table Model )
 
**Сценарий транзакций** - простейший подход к описанию бизнес логики, связан с процедурой получения информации от слоя представления, 
обрабатывая ее, активизирует операции других систем, выполняет проверки и сохраняет информацию в  БД. Далее процедура возвращает слою представления данные, возможно обрабатывая их.

Преимущества:
- Удобная процедурная модель, легко воспринимать всем разработчикам.
- Сочетание с простыми схемами организации слоя источника данных:
    - Шлюз записи данных ( Row Data Gateway )
    - Шлюз таблицы данных ( Table Data Gateway )
- Определяет четкие границы транзакции

Недостатки:
 - Может возникнуть опасность дублирования фрагментов кода, за счет схожести функций нескольких транзакций

**Модель предметной области** - система абстракций, которая описывает определенные аспекты предметной области.
Обычно реализуется как объектная модель на уровне, который использует более низкий уровень устойчивости 
и публикует API для обеспечения доступа к данным и поведению модели на более высоком уровне.

**Модуль таблицы** - организация логики вокруг таблиц. Эффективность применения зависит от уровня поддержки структуры - множества записей ( .NET )
Преимущества:
- Сочетание с другими аспектами архитектуры. Многие графические сферы работают с результатом обработки СКЛ запроса, организованном в виде записи.
Недостатки:
- Не позволяет использовать многие технологии ( наследование, стратегии ) и тд.  

PS: Нередко на деле **сценарий транзакций** используется для некоторого формирования фрагмента бизнес-логики, а 
**модель предметной области** или **модуль таблицы** - для оставшейся части

**Уровень служб** - подход реализации бизнес-логики состоит в расщеплении слоя предметной области на два самостоятельных слоя.

Сверху над 'модель предметной области' или 'модуль таблицы' располагается - Слой служб

**Слой служб ( Service Layer )** - промежуточный интерфейс который направляет адресуемые ему вызовы к нижележащим объектам. 
Он обеспечивает API, а также берет ответственность за управлениями транзакциями и проверку безопасности.